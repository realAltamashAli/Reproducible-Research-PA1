---
title: "Reproducible Research: Peer Assessment 1"
author: "Altamash"
output: html_document
---

This report analyzes personal activity monitoring data collected at 5-minute intervals.

## Loading and preprocessing the data

```{r}
data <- read.csv("activity.csv")
data$date <- as.Date(data$date)

total_steps <- aggregate(steps ~ date, data, sum, na.rm = TRUE)

hist(total_steps$steps,
main = "Histogram of Total Steps per Day",
xlab = "Steps")

mean(total_steps$steps)
median(total_steps$steps)

avg_interval <- aggregate(steps ~ interval, data, mean, na.rm = TRUE)

plot(avg_interval$interval,
avg_interval$steps,
type = "l",
xlab = "Interval",
ylab = "Average Steps")

avg_interval[which.max(avg_interval$steps), ]

sum(is.na(data$steps))

imputed_data <- data
interval_means <- aggregate(steps ~ interval, data, mean, na.rm = TRUE)

na_idx <- is.na(imputed_data$steps)
imputed_data$steps[na_idx] <-
interval_means$steps[match(imputed_data$interval[na_idx],
interval_means$interval)]

imputed_total <- aggregate(steps ~ date, imputed_data, sum)

hist(imputed_total$steps,
main = "Histogram After Imputation",
xlab = "Steps")

mean(imputed_total$steps)
median(imputed_total$steps)

imputed_data$day_type <- ifelse(
weekdays(imputed_data$date) %in% c("Saturday", "Sunday"),
"Weekend",
"Weekday"
)

library(lattice)

avg_day <- aggregate(steps ~ interval + day_type,
imputed_data,
mean)

xyplot(steps ~ interval | day_type,
avg_day,
type = "l")
```

